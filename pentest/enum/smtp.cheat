% PEN - smtp

# interact with the SMTP server
telnet <TARGET_IP> 25

# the actual initialization of the session is done with the command HELO or EHLO
HELO <mail1_domain_com>

# enumerate existing users on the system
VRFY <USER>

# footprinting - ls /usr/share/nmap/scripts | rg smtp
sudo nmap <TARGET_IP> -sC -sV -p25

# this script uses the EHLO command to list all possible commands that can be executed on the target SMTP server
sudo nmap -p25 --script smtp-commands <TARGET_IP>
# if VRFY command is available you can attempt to enumerate users on the system
sudo nmap -p25 --script smtp-enum-users --script-args smtp-enum-users.methods={VRFY} <TARGET_IP>

# enumerate users using different footprinting wordlist
smtp-user-enum -M VRFY -U footprinting-wordlist.txt -t <TARGET_IP> -v -p 25 -w 20 -m 60
# or try using nmap
sudo nmap -p25 --script smtp-enum-users --script-args smtp-enum-users.methods={VRFY},smtp-enum-users.userdb=~/playground/footprinting-wordlist.txt <TARGET_IP> -v

# identify the target SMTP server as an open relay using 16 different tests
sudo nmap -p25 --script smtp-open-relay <TARGET_IP> -v
